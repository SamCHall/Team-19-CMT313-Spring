{% extends "base.html" %}

{% block head %}
    {% assets "graph" %}
    <script type="text/javascript" src="{{ ASSET_URL }}"></script>
    {% endassets %}
{% endblock head %}

{% block content %}

{% if question.submissions | length > 0 %}
<section class="container">
    <div class="card">
        <div class="card-header">
            <h1 class="card-title">{{ question.title }} - Stats</h1>
        </div>

        {# Include html file with code to display question here #}

        <div class="card-body stats-outer">
            <div class="card-group">
                <div class="card stats-inner">
                    <div class="card-body">
                        <h2>Overall performance</h2>
                        {# Stats for the question as a whole #}
                        <ul>
                            <li>Number of submissions: {{ question.submissions | length }}</li>
                            <li>Number of blanks: {{ question.num_of_blanks() }}</li>
                            <li>Average Mark: {{ question.average_mark() }}</li>
                            <li>Lowest Mark: {{ question.lowest_mark() }}</li>
                            <li>Highest Mark: {{ question.highest_mark() }}</li>
                        </ul>
                    </div>
                </div>

                <div class="card stats-inner">
                    <div class="card-body">
                        {% set mark_dist = question.mark_dist() %}

                        <div id="overallGraph" class="graph"></div>

                        <script type="text/javascript">
                        {
                            let data = [
                                {
                                    x : {{ mark_dist.keys() | list }},
                                    y : {{ mark_dist.values() | list }},
                                    type : 'bar'
                                }
                            ];
                            displayGraph('overallGraph', 'Mark distribution', data)
                        }
                        </script>
                    </div>
                </div>
            </div>
        </div>
    </div>
</section>

{# Stats foreach blank word #}

{% for count in range(0, question.num_of_blanks()) %}
{% include "stats/question_type1_blank.html" %}
{% endfor %}

{% else %}
<section class="container">
    <div class="card">
        <div class="card-header">
            <h1 class="card-title">{{ question.title }} - Stats</h1>
        </div>
        <div class="card-body">
            <p>There are currently no submissions for this question.</p>
        </div>
    </div>
</section>
{% endif %}

{% endblock content %}
